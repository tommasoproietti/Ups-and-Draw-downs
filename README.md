# Reproducibility Package for: Ups and (Draw)downs

**Date assembled:** 2025-07-04  
**Author: Tommaso Proietti ‚Äì University of Rome Tor Vergata
          Email: tommaso.proietti@uniroma2.it 
 
 ---
## üìä Data Files

### üîπ Raw Time Series Data

| File        | Description                            | Format | Source         |
|-------------|----------------------------------------|--------|----------------|
| `^GSPC.csv` | Daily S&P 500 index                    | CSV    | Yahoo Finance  |
| `sp500.mat` | Time series of 503 S&P500 component stocks | MAT    | Proprietary    |

### üîπ Generated Data Files

These files are outputs generated by the provided scripts.

| File                              | Description                                                      | Produced By                          |
|-----------------------------------|------------------------------------------------------------------|--------------------------------------|
| `sSP500_Peaks_Troughs_Multivariate.mat` | Output from multivariate peak/trough detection                  | `sSP500_Peaks_Troughs_Multivariate.m` |
| `sSP500_tau_multivariate.mat`     | Tau-drawdowns and tau-drawups for component series               | `sSP500_tau_multivariate.m`          |
| `sRollingForecasts.mat`           | Rolling forecasts via sequential Monte Carlo (Formula (8))       | `sRollingForecasts.m`                |
| `sRollingForecasts_dd.mat`        | Direct forecasts (D-ARMA, D-ARIMA, D-HAR)                         | `sRollingForecasts_dd.m`             |
| `sRollingForecasts_cond.mat`      | Conditional forecasts (C-HAR)                                    | `sRollingForecasts_cond.m`           |
| `sRollingForecasts_cond_factor.mat` | Conditional forecasts (C-Factor HAR)                            | `sRollingForecasts_cond_factor.m`    |

 ---
## üìú Script Files

These MATLAB scripts reproduce the tables and figures from various sections of the paper.

### üîπ Section 2: Descriptive Analysis

| File                         | Description                                           |
|------------------------------|-------------------------------------------------------|
| `sSP500_Figure1Table1.m`     | Produces Figure 1 and Table 1 (S&P500 drawdown overview) |
| `sSP500_Peaks_Troughs.m`     | Identifies peaks and troughs in the S&P500 index (Figure 2) |

### üîπ Section 4: Multivariate Dating and Tau-Drawdowns

| File                                  | Description                                               |
|---------------------------------------|-----------------------------------------------------------|
| `sSP500_Peaks_Troughs_Multivariate.m` | Detects peaks/troughs in the 503 component series         |
| `sSP500_tau_multivariate.m`          | Computes tau-drawdowns and tau-drawups of components      |

### üîπ Section 5: Dependence Structure

| File                            | Description                                       |
|----------------------------------|---------------------------------------------------|
| `sSP500_Correlation_Results.m`   | Generates Figures 3 and 4 (correlation structure) |
| `sSP500_CDaR_tau_alpha.m`        | Produces Figures 5 and 6 (CDaR statistics)        |

### üîπ Section 6.3: Robust Estimation

| File              | Description                                  |
|-------------------|----------------------------------------------|
| `sSP500_robust.m` | Robust estimates of drawdowns (_
 ---
## üìÅ Repository Structure

- `data/`: MATLAB `.mat` files and CSVs used for analysis and forecasting.
- `scripts/`: MATLAB scripts for generating all figures and tables in the paper.
- `functions/`: Custom MATLAB functions used in the scripts.
- `README.md`: This document.
- `LICENSE`: License information (e.g., MIT, CC-BY-NC).
- `reproduce_all.m`: Master script to reproduce all figures and tables (optional).

---
## ‚öôÔ∏è Functions

The following custom MATLAB functions are used throughout the analysis:

| File                         | Description                                           |
|------------------------------|-------------------------------------------------------|
| `fMaxFilter.m`               | Realizes max (min), drawdown (up), and lead time processes |
| `fBearBullDating.m`          | Implements the dating algorithm for turning points   |
| `fGoodmanKruskal.m`          | Computes Goodman and Kruskal‚Äôs gamma statistic       |
| `fSsfMBfiltering.m`          | State space decomposition model                      |
| `fAugmentedStateSmoother.m`  | Kalman filtering and smoothing implementation        |

## üíª Computing Environment

- **Language**: MATLAB R2023a  
- **Toolboxes used**: Statistics and Machine Learning, Econometrics Toolbox, Parallel Computing  
- **Platform**: Windows 
- **Expected runtime**: ~ 20 minutes on Intel i7, 16 GB RAM
- **Special setup**:  parallel computing enhances speed

---

## üîß Running the Reproducibility Check

Each script is self-contained and will generate the corresponding tables/figures as in the paper. The typical workflow is:

### To reproduce Section 2:

```matlab
run('scripts/sSP500_Figure1Table1.m')
