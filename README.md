# Reproducibility Package for: Ups and (Draw)downs

**Date assembled:** 2025-07-04  
**Author: Tommaso Proietti ‚Äì University of Rome Tor Vergata
          Email: tommaso.proietti@uniroma2.it 
 
 ---
## üìä Data Files

### üîπ Raw Time Series Data

| File        | Description                                 | Format | Source         |
|-------------|---------------------------------------------|--------|----------------|
| `^GSPC.csv` | Daily S&P 500 index                         | CSV    | Yahoo Finance  |
| `sp500.mat` | Time series of 501 S&P500 component stocks closing prices | MAT    | Proprietary - data were downloaded from Yahoo finance and transformed into a Matlab Timetable   |

### üîπ Generated Data Files

These files are outputs generated by the provided scripts.

| File                              | Description                                                      | Produced By                          |
|-----------------------------------|------------------------------------------------------------------|--------------------------------------|
| `sSP500_Peaks_Troughs_Multivariate_Bear_Diff.mat` | Output from multivariate peak/trough detection                  | `sSP500_Peaks_Troughs_Multivariate.m` (diffusion index)|
| `sSP500_tau_multivariate.mat`     | Tau-drawdowns and tau-drawups for component series               | `sSP500_tau_multivariate.m`          |
| `sRollingForecasts_PMC.mat`           | Rolling forecasts via sequential Monte Carlo (Formula (8))       | `sRollingForecasts_PMC.m`                |
| `sRollingForecasts_D_ARMA_ARIMA_HAR.mat`        | Direct forecasts (D-ARMA, D-ARIMA, D-HAR)                         | `sRollingForecasts_D_ARMA_ARIMA_HAR.m`             |
| `sRollingForecasts_C_HAR.mat`      | Conditional forecasts (C-HAR)                                    | `sRollingForecasts_C_HAR.m`           |
| `sRollingForecasts_C_Factor_HAR.mat` | Conditional forecasts (C-Factor HAR)                            | `sRollingForecasts_C_Factor_HAR.m`    |

 ---
## üìú Script Files

These MATLAB scripts reproduce the tables and figures from various sections of the paper.

### üîπ Section 2: Illustrative Examples and Descriptive Analysis

| File                         | Description                                           |
|------------------------------|-------------------------------------------------------|
| `sSP500_Figure1Table1.m`     | S&P500: maxima, minima, drawdown, drawup and current lead time, and their characteristics (produces Figure 1 and Table 1)|
| `sSP500_Peaks_Troughs.m`     | Identifies peaks and troughs in the S&P500 index (Figure 2) |

### üîπ Section 4: Multivariate Dating and Tau-Drawdowns

| File                                  | Description                                               |
|---------------------------------------|-----------------------------------------------------------|
| `sSP500_Peaks_Troughs_Multivariate.m` | Detects peaks/troughs and identifies bull and bear phases in the component series. The output is in the Matlab file sSP500_Peaks_Troughs_Multivariate.mat |
| `sSP500_tau_multivariate.m`          | Computes tau-drawdowns and tau-drawups of component series for tau ranging from 1 to 65. The output is in the Matlab file sSP500_tau_multivariate.mat|

### üîπ Section 5: Dependence Structure

| File                            | Description                                       |
|----------------------------------|---------------------------------------------------|
| `sSP500_Multivariate.m`   | Stylized facts - Generates Figures 3 and 4 (correlation structure) |
| `sSP500_CDaR_tau_alpha.m`        | Analysis of CDaR - Produces Figures 5 and 6 (CDaR statistics)        |

### üîπ Section 6.3: Robust Estimation

| File              | Description                                  |
|-------------------|----------------------------------------------|
| `sSP500_robust.m` | Robust estimation of drawdowns (section 7.3 of the paper)
 ---
## üìÅ Repository Structure

- `data/`: MATLAB `.mat` files and CSVs used for analysis and forecasting.
- `scripts/`: MATLAB scripts for generating all figures and tables in the paper.
- `functions/`: Custom MATLAB functions used in the scripts.
- `README.md`: This document.
- `LICENSE`: License information (e.g., MIT, CC-BY-NC).
- `reproduce_all.m`: Master script to reproduce all figures and tables (optional).

---
## ‚öôÔ∏è Functions

The following custom MATLAB functions are used throughout the analysis:

| File                         | Description                                           |
|------------------------------|-------------------------------------------------------|
| `fMaxFilter.m`               | Realizes max (min), drawdown (up), and lead time processes |
| `fBearBullDating.m`          | Implements the dating algorithm for turning points   |
| `fGoodmanKruskal.m`          | Computes Goodman and Kruskal‚Äôs gamma statistic       |
| `fSsfMBfiltering.m`          | State space decomposition model (used in section 7.3 for robust drawdown estimation                     |
| `fACGF.m`                    | Autocovariance generating function State space decomposition model (used by fSsfMBfiltering.m)             |
| `fSpectralFactorisation.m`          | Spectral factorisation, based on Sayed and Kailath, 2001  (used by fSsfMBfiltering.m)                      |
| `fAugmentedStateSmoother.m`  | Augmented Kalman filtering and smoothing (estimation of lowpass component)        |
| `fDieboldMariano.m`  | Diebold-Mariano test statistic       |


## üíª Computing Environment

- **Language**: MATLAB R2023a  
- **Toolboxes used**: Statistics and Machine Learning, Econometrics Toolbox, Parallel Computing  
- **Platform**: Windows 
- **Expected runtime**: ~ 30 minutes on Intel i7, 16 GB RAM
- **Special setup**:  parallel computing enhances speed

---

## üîß Running the Reproducibility Check

Each script is self-contained and will generate the corresponding tables/figures as in the paper.  
